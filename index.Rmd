---
title: "Exercise Execution Prediction"
author: "Ricardo Costa"
date: "5/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
set.seed(3523)
```

```{r libraries, include=FALSE, echo=FALSE}
library(caret)
library(ggplot2)
library(dplyr)
```

```{r load, include=FALSE, echo=FALSE}
pmltraining = read.csv("pml-training.csv")
pmltesting = read.csv("pml-testing.csv")
```

```{r partition, include=FALSE, echo=FALSE}
#inTrain = createDataPartition(pmltraining$classe, p = 0.8)[[1]]
#cvtraining = pmltraining[ inTrain,]
#cvtesting = pmltraining[-inTrain,]

# Removing unneeded data
training <- subset(pmltraining, select = -c(user_name,raw_timestamp_part_1,raw_timestamp_part_2, cvtd_timestamp, new_window, num_window))
testing <- subset(pmltesting, select = -c(user_name,raw_timestamp_part_1,raw_timestamp_part_2, cvtd_timestamp, new_window, num_window))

# Removing columns with few data
 
allnames <- names(training)

removenames <- allnames[grepl(allnames,pattern = "^max_*")]
removenames <-  c(removenames, allnames[grepl(allnames,pattern = "^min_*")])
removenames <-  c(removenames, allnames[grepl(allnames,pattern = "^amplitude_*")])
removenames <-  c(removenames, allnames[grepl(allnames,pattern = "^var_*")])
removenames <-  c(removenames, allnames[grepl(allnames,pattern = "^avg_*")])
removenames <-  c(removenames, allnames[grepl(allnames,pattern = "^stddev_*")])

keepnames <- allnames[!(allnames %in% removenames)]

training <- training[, keepnames]
testing <- testing[, keepnames]
```

```{r train, include=FALSE, echo=FALSE}
trainCtrl <- trainControl(method = "cv")
rfFit <- train(classe ~ ., method="rf", data=training, trControl=trainCtrl)
boostFit <- train(classe ~ ., method="gbm", data=training, trControl=trainCtrl)
ldaFit <- train(classe ~ ., method="lda", data=training, trControl=trainCtrl)
rpartFit <- train(classe ~ ., method="rpart", data=training, trControl=trainCtrl)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
